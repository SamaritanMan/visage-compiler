<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
  "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<?xml-stylesheet href="docbook.css" type="text/css"?>
<chapter id="Logic">
<title>Logic</title>


<sect1 id="log"><title>Logic Overview </title>
<para>
<emphasis>This Chapter explains statements, logic constructs, methods operations and functions, and other JavaFX Script programming mechanisms. 
</emphasis>  
</para>


<sect2 id="lquestions"><title>Questions</title>
<para>
<emphasis>We need to explain all statement forms, starting with expression statements. Control flow statement section should follow a general intro and a brief bulleted list of other statement forms.
</emphasis>
</para>

<para><emphasis>The section below should really discuss methods, functions and operations. </emphasis></para>

<para><emphasis>Where should we discuss packages, JavaFX Script file structure, and how to call my own custom Java classes? </emphasis></para>


</sect2>

</sect1>

        <sect1 id="operations">
          <title>Operations</title>
	  
	  <para><emphasis role="bold">An operation is NOT an expression (below)</emphasis></para>
	  
	  <para><emphasis>This section really should discuss methods, functions and operations. </emphasis></para>

          <para>In JavaFX, procedures are declared with the
          <code>operation</code> keyword. For example:</para>

          <programlisting>        import java.lang.StringIndexOutOfBoundsException;

        operation substring(s:String, n:Number): String {
              try {
                  return s.substring(n);
              } catch (e:StringIndexOutOfBoundsException) {
                  throw "sorry, index out of bounds";
              }
        }
</programlisting>

          <para>The above example defines a new procedure called
          "<code>substring</code>" with two arguments, the first named "s" of
          type "String", the second named "n" of type "Number", returning type
          "String".</para>

          <para>In addition to the <code>assignment</code>,
          <code>delete</code>, and <code>insert</code> statements mentioned
          above, the following statements are possible inside the body of an
          operation :</para>
       
	 
	    <sect2 id="statem">
          <title>Statements</title>
	  
	  <para><emphasis>Introduction to Statements. </emphasis></para>

         
        </sect2>
	  
	  
	 
       <sect2 id="express">
          <title>Expression Statements</title>
	  
	  <para><emphasis role="bold">An expression is NOT an operation (above)</emphasis></para>

          <para>A primary expression may be used as a statement, for
          example:</para>

          <programlisting>       System.out.println("Hello World!");
</programlisting>
        </sect2>

	 

	
        <sect2 id="if">
          <title>If Statement</title>

          <para>The JavaFX <code>if</code> statement is like Java's except
          that curly braces are always required around the then and else
          clauses, unless the the else clause is another <code>if</code>
          statement.</para>

          <para>Example:</para>

          <programlisting>       if (condition1) {
           System.out.println("Condition 1");
       } else if (condition2) {
           System.out.println("Condition2");
       } else {
           System.out.println("not Condition 1 or Condition 2");
       }
</programlisting>
        </sect2>
	
	

	
        <sect2 id="while">
          <title>While Statement</title>

          <para>The JavaFX <code>while</code> statement is like Java's except
          that curly braces are always required around the body.</para>

          <para>Example:</para>

          <programlisting>       var i = 0;
       while (i &lt; 10) {
           if (i &gt; 5) {
              break;
           }
           System.out.println("i = {i}");
           i += 1;
       }
</programlisting>
        </sect2>

        <sect2 id="try">
          <title>Try Statement</title>

          <para>The JavaFX <code>try</code> statement is like Java's but with
          JavaFX variable declaration syntax. Note: in JavaFX any object can
          be thrown and caught, not just those that extend
          <code>java.lang.Throwable</code>.</para>

          <para>Example:</para>

          <programlisting>       try {
          throw "Hello";
       } catch (s:String) {
          System.out.println("caught a String: {s}");
       } catch (any) {
          System.out.println("caught something not a String: {any}");
       } finally {
          System.out.println("finally...");
       }
</programlisting>
        </sect2>

        <sect2 id="for">
          <title>For Statement</title>

          <para>The header of the JavaFX <code>for</code> statement uses the
          same syntax as the <code>foreach</code> list comprehension operator.
          However, in this case the body of the statement is executed for each
          element generated by the list comprehension.</para>

          <para>Examples:</para>

          <programlisting>        for (i in [0..10]) {
             System.out.println("i = {i}");
        }

        // print only the even numbers using a filter
        for (i in [0..10] where i % 2 == 0) {
             System.out.println("i = {i}");
        }

        // print only the odd numbers using a range expression
        for (i in [1,3..10]) {
             System.out.println("i = {i}");
        }

        // print the cartesian product
        for (i in [0..10], j in [0..10]) {
             System.out.println(i);
             System.out.println(j);
        }

</programlisting>
        </sect2>

        <sect2 id="return">
          <title>Return Statement</title>

          <para>The JavaFX <code>return</code> statement is like
          Java's:</para>

          <para>Example:</para>

          <programlisting>       operation add(x, y) {
           return x + y;
       }
</programlisting>
</sect2>

          <sect2 id="throw">
            <title>Throw Statement</title>

            <para>The JavaFX <code>throw</code> statement is like Java's.
            However, any object may be thrown, not just those that extend
            <code>java.lang.Throwable</code>.</para>

            <para>Examples:</para>

            <programlisting>       import java.lang.Exception;

       operation foo() {
           throw new Exception("this is a java exception");
       }

       operation bar() {
           throw "just a string";
       }
</programlisting>
          </sect2>

          <sect2 id="break">
            <title>Break and Continue Statements</title>

            <para>The JavaFX <code>break</code> and <code>continue</code>
            statements are like Java's, however labels are not supported. As
            in Java, <code>break</code> and <code>continue</code> must appear
            inside the body of a <code>while</code> or <code>for</code>
            statement.</para>

            <para>Examples:</para>

            <programlisting>       operation foo() {
          for (i in [0..10]) {
              if (i &gt; 5) {
                  break;
              }
              if (i % 2 == 0) {
                  continue;
              }
              System.out.println(i);
          }
       }

       operation bar() {
           var i = 0;
           while (i &lt; 10) {
               if (i &gt; 5) {
                   break;
               }
               if (i % 2 == 0) {
                   continue;
               }
               System.out.println(i);
               i += 1;
           }
       }
</programlisting>
          </sect2>

          <sect2 id="do">
            <title>Do Statement</title>

            <para>The JavaFX <code>do</code> statement allows you to execute a
            block of JavaFX code in a background thread while allowing the AWT
            Event Dispatch Thread to continue processing events, thereby
            preventing the UI from appearing to hang. Currently, this is
            implemented by using <code>java.awt.EventQueue</code> to pump
            events while the background thread is executing. Normally, all
            JavaFX code executes in the AWT Event Dispatch Thread. Only code
            contained in the body of a <code>do</code> statement is allowed to
            execute in another thread. Such code must only access Java objects
            (and those objects must handle their own thread synchronization,
            if necessary).</para>

            <para>Example:</para>

            <programlisting>        import java.net.URL;
        import java.lang.StringBuffer;
        import java.lang.System;
        import java.io.InputStreamReader;
        import java.io.BufferedReader;



        // in the AWT EDT
        var result = new StringBuffer();

        do {
             // now in a background thread
             var url = new URL("http://www.foo.com/abc.xml");
             var is = url.openStream();
             var reader = new BufferedReader(new InputStreamReader(is));
             var line;
             while (true) {
                  line = reader.readLine();
                  if (line == null) {
                       break;
                  }
                  result.append(line);
                  result.append("\n");
             }
        } 

        // now back in the EDT
        System.out.println("result = {result}"); 
</programlisting>

            <para>In the above example, the green code which is executing in
            the EDT appears to be blocked during the execution of the body of
            the <code>do</code> statement (the red code). However, a new event
            dispatch loop is created on the stack while waiting for the
            background thread to complete. As a result, GUI events continue to
            be processed while the <code>do</code> statement is executing.
            <emphasis>Unfortunately, this isn't a perfect solution, however,
            since it can cause multiple event dispatch loops to build up on
            the stack - in the degenerate case causing a stack overflow
            exception</emphasis>.</para>
          </sect2>

          <sect2 id="dolater">
            <title>do later Statement</title>

            <para>The <code>do</code> statement has a second form (<code>do
            later</code>) that allows for asynchronous execution of its body
            in the EDT rather than synchronous execution in a background
            thread (providing the functionality of
            <code>java.awt.EventQueue.invokeLater</code>) Here's an
            example:</para>

            <programlisting>        import java.lang.System;
        var saying1 = "Hello World!";
        var saying2 = "Goodbye Cruel World!";
        do later {
             System.out.println(saying1);
        }
        System.out.println(saying2);
</programlisting>

            <para>Running this code produces the following output:</para>

            <programlisting>        Goodbye Cruel World!
        Hello World!
</programlisting>
          </sect2>

</sect1>




</chapter>



